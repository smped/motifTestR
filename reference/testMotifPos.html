<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Test for a Uniform Distribution across a set of best matches — testMotifPos • motifTestR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Test for a Uniform Distribution across a set of best matches — testMotifPos"><meta property="og:description" content="Test for a Uniform Distribution across a set of best matches"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">motifTestR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.2</span>
      </span>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/motifAnalysis.html">Basic Motif Analysis</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/smped/motifTestR" class="external-link">
    <span class="fa fa-github fa-lg"></span>
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Test for a Uniform Distribution across a set of best matches</h1>
    <small class="dont-index">Source: <a href="https://github.com/smped/motifTestR/blob/HEAD/R/testMotifPos.R" class="external-link"><code>R/testMotifPos.R</code></a></small>
    <div class="hidden name"><code>testMotifPos.Rd</code></div>
    </div>
    <div class="ref-description">
    <p>Test for a Uniform Distribution across a set of best matches</p>
    </div>
    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">testMotifPos</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">stringset</span>,</span>
<span>  binwidth <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  abs <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  rc <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  min_score <span class="op">=</span> <span class="st">"80%"</span>,</span>
<span>  break_ties <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>  alt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"greater"</span>, <span class="st">"less"</span>, <span class="st">"two.sided"</span><span class="op">)</span>,</span>
<span>  sort_by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p"</span>, <span class="st">"none"</span><span class="op">)</span>,</span>
<span>  mc.cores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>
    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A Position Weight Matrix, universalmotif object or list thereof.
Alternatively can be a single DataFrame or list of DataFrames as returned
by <a href="getPwmMatches.html">getPwmMatches</a> with <code>best_only = TRUE</code></p></dd>
<dt id="arg-stringset">stringset<a class="anchor" aria-label="anchor" href="#arg-stringset"></a></dt>
<dd><p>An XStringSet. Not required if matches are supplied as x</p></dd>
<dt id="arg-binwidth">binwidth<a class="anchor" aria-label="anchor" href="#arg-binwidth"></a></dt>
<dd><p>Width of bins across the range to group data into</p></dd>
<dt id="arg-abs">abs<a class="anchor" aria-label="anchor" href="#arg-abs"></a></dt>
<dd><p>Use absolute positions around zero to find symmetrical enrichment</p></dd>
<dt id="arg-rc">rc<a class="anchor" aria-label="anchor" href="#arg-rc"></a></dt>
<dd><p>logical(1) Also find matches using the reverse complement of pwm</p></dd>
<dt id="arg-min-score">min_score<a class="anchor" aria-label="anchor" href="#arg-min-score"></a></dt>
<dd><p>The minimum score to return a match</p></dd>
<dt id="arg-break-ties">break_ties<a class="anchor" aria-label="anchor" href="#arg-break-ties"></a></dt>
<dd><p>Choose how to resolve matches with tied scores</p></dd>
<dt id="arg-alt">alt<a class="anchor" aria-label="anchor" href="#arg-alt"></a></dt>
<dd><p>Alternative hypothesis for the binomial test</p></dd>
<dt id="arg-sort-by">sort_by<a class="anchor" aria-label="anchor" href="#arg-sort-by"></a></dt>
<dd><p>Column to sort results by</p></dd>
<dt id="arg-mc-cores">mc.cores<a class="anchor" aria-label="anchor" href="#arg-mc-cores"></a></dt>
<dd><p>Passed to <a href="https://rdrr.io/r/parallel/mclapply.html" class="external-link">mclapply</a></p></dd>
<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Passed to <a href="https://rdrr.io/pkg/Biostrings/man/matchPWM.html" class="external-link">matchPWM</a></p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
<p>A data.frame with columns <code>start</code>, <code>end</code>, <code>centre</code>, <code>width</code>, <code>total_matches</code>,
<code>matches_in_region</code>, <code>expected</code>, <code>enrichment</code>, <code>prop_total</code>, <code>p</code></p>
<p>and <code>consensus_motif</code></p>
<p>The total matches represent the total number of matches within the set of
sequences, whilst the number observed in the final region are also given,
along with the proportion of the total this represents.
Enrichment is simply the ratio of observed to expected based on the
expectation of the null hypothesis</p>
<p>The consensus motif across all matches is returned as a Position Frequency
Matrix (PFM) using <a href="https://rdrr.io/pkg/Biostrings/man/letterFrequency.html" class="external-link">consensusMatrix</a>.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function tests for an even positional spread of motif matches across a
set of sequences, using the assumption (i.e. H~0~) that if there is no
positional bias, matches will be evenly distributed across all positions
within a set of sequences.
Conversely, if there is positional bias, typically but not necessarily near
the centre of a range, this function intends to detect this signal, as a
rejection of the null hypothesis.</p>
<p>Input can be provided as the output from <a href="getPwmMatches.html">getPwmMatches</a> setting
<code>best_only = TRUE</code> if these matches have already been identified.
If choosing to provide this object to the argument <code>matches</code>, nothing is required
for the arguments <code>pwm</code>, <code>stringset</code>, <code>rc</code>, <code>min_score</code> or <code>break_ties</code>
Otherwise, a Position Weight Matrix (PWM) and an <code>XStringSet</code> are required,
along with the relevant arguments, with best matches identified within the
function.</p>
<p>The set of best matches are then grouped into bins along the range, with the
central bin containing zero, and tallied.
Setting <code>abs</code> to <code>TRUE</code> will set all positions from the centre as
<em>absolute values</em>, returning counts purely as bins with distances from zero,
marking this as an inclusive lower bound.
Motif alignments are assigned into bins based on the central position of the
match, as provided in the column <code>from_centre</code> when calling
<a href="getPwmMatches.html">getPwmMatches</a>.</p>
<p>The <a href="https://rdrr.io/r/stats/binom.test.html" class="external-link">binom.test</a> is performed on each bin using the alternative
hypothesis, with the returned p-values across all bins combined using the
Harmonic Mean p-value (HMP) (See <a href="https://rdrr.io/pkg/harmonicmeanp/man/p.hmp.html" class="external-link">p.hmp</a>).
All bins with raw p-values below the HMP are identified and the returned
values for start, end, centre, width, matches in region, expected and
enrichment are across this set of bins.
The expectation is that where a positional bias is evident, this will be a
narrow range containing a non-trivial proportion of the total matches.</p>
<p>It should also be noted that <code><a href="https://rdrr.io/r/stats/binom.test.html" class="external-link">binom.test()</a></code> can return p-values of zero, as
beyond machine precision. In these instances, zero p-values are excluded from
calculation of the HMP. This will give a very slight conservative bias, and
assumes that for these extreme cases, neighbouring bins are highly likely to
also return extremely low p-values and no significance will be lost.</p>
    </div>
    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Load the example PWM</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ex_pwm"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">esr1</span> <span class="op">&lt;-</span> <span class="va">ex_pwm</span><span class="op">$</span><span class="va">ESR1</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Load the example sequences</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ar_er_seq"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Get the best match and use this data</span></span></span>
<span class="r-in"><span><span class="va">matches</span> <span class="op">&lt;-</span> <span class="fu"><a href="getPwmMatches.html">getPwmMatches</a></span><span class="op">(</span><span class="va">esr1</span>, <span class="va">ar_er_seq</span>, best_only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Test for enrichment in any position</span></span></span>
<span class="r-in"><span><span class="fu">testMotifPos</span><span class="op">(</span><span class="va">matches</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   start end centre width total_matches matches_in_region expected enrichment</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  -165 185     10   350            45                38 27.90698   1.361667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   prop_total         p       fdr consensus_motif</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  0.8444444 0.9741004 0.9741004    30, 2, 1....</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Provide a list of PWMs, testing for distance from zero</span></span></span>
<span class="r-in"><span><span class="fu">testMotifPos</span><span class="op">(</span><span class="va">ex_pwm</span>, <span class="va">ar_er_seq</span>, abs <span class="op">=</span> <span class="cn">TRUE</span>, binwidth <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       start end centre width total_matches matches_in_region     expected</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ESR1     10  40     25    30            45                15   6.99481865</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ANDR      0 190     95   190            53                28  13.80208333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FOXA1     0 190     95   190           179               110 100.97435897</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ZN281    60 190    125   130            36                29  18.65284974</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ZN143   120 130    125    10             1                 1   0.05263158</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       enrichment prop_total         p       fdr consensus_motif</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ESR1    2.144444  0.3333333 0.2493238 0.7445537    30, 2, 1....</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ANDR    2.028679  0.5283019 0.2978215 0.7445537    4, 3, 2,....</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FOXA1   1.089385  0.6145251 0.8064541 0.9520175    6, 0, 0,....</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ZN281   1.554722  0.8055556 0.8349283 0.9520175    5, 0, 25....</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ZN143  19.000000  1.0000000 0.9520175 0.9520175    1, 0, 0,....</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>
      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://github.com/smped" class="external-link">Stevie Pederson</a>.</p>
</div>
<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.9000.</p>
</div>
      </footer></div>
  </body></html>

