<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Find matches from a PWM cluster within an XStringSet — getClusterMatches • motifTestR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Find matches from a PWM cluster within an XStringSet — getClusterMatches"><meta property="og:description" content="Find matches from a PWM cluster within a set of sequences"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">motifTestR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/motifAnalysis.html">Basic Motif Analysis</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/smped/motifTestR" class="external-link">
    <span class="fa fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Find matches from a PWM cluster within an XStringSet</h1>
    <small class="dont-index">Source: <a href="https://github.com/smped/motifTestR/blob/HEAD/R/getClusterMatches.R" class="external-link"><code>R/getClusterMatches.R</code></a></small>
    <div class="hidden name"><code>getClusterMatches.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Find matches from a PWM cluster within a set of sequences</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">getClusterMatches</span><span class="op">(</span></span>
<span>  <span class="va">cl</span>,</span>
<span>  <span class="va">stringset</span>,</span>
<span>  rc <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  min_score <span class="op">=</span> <span class="st">"80%"</span>,</span>
<span>  best_only <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  break_ties <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"all"</span>, <span class="st">"random"</span>, <span class="st">"first"</span>, <span class="st">"last"</span>, <span class="st">"central"</span><span class="op">)</span>,</span>
<span>  mc.cores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">countClusterMatches</span><span class="op">(</span></span>
<span>  <span class="va">cl</span>,</span>
<span>  <span class="va">stringset</span>,</span>
<span>  rc <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  min_score <span class="op">=</span> <span class="st">"80%"</span>,</span>
<span>  mc.cores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-cl">cl<a class="anchor" aria-label="anchor" href="#arg-cl"></a></dt>
<dd><p>A list of Position Weight Matrices, universalmotifs, with each
element representing clusters of related matrices</p></dd>


<dt id="arg-stringset">stringset<a class="anchor" aria-label="anchor" href="#arg-stringset"></a></dt>
<dd><p>An XStringSet</p></dd>


<dt id="arg-rc">rc<a class="anchor" aria-label="anchor" href="#arg-rc"></a></dt>
<dd><p>logical(1) Also find matches using the reverse complement of pwm</p></dd>


<dt id="arg-min-score">min_score<a class="anchor" aria-label="anchor" href="#arg-min-score"></a></dt>
<dd><p>The minimum score to return a match</p></dd>


<dt id="arg-best-only">best_only<a class="anchor" aria-label="anchor" href="#arg-best-only"></a></dt>
<dd><p>logical(1) Only return the best match</p></dd>


<dt id="arg-break-ties">break_ties<a class="anchor" aria-label="anchor" href="#arg-break-ties"></a></dt>
<dd><p>Method for breaking ties when only returning the best match
Ignored when all matches are returned (the default)</p></dd>


<dt id="arg-mc-cores">mc.cores<a class="anchor" aria-label="anchor" href="#arg-mc-cores"></a></dt>
<dd><p>Passed to <a href="https://rdrr.io/r/parallel/mclapply.html" class="external-link">mclapply</a> if passing multiple PWMs</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Passed to <a href="https://rdrr.io/pkg/Biostrings/man/matchPWM.html" class="external-link">matchPWM</a></p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Output from getClusterMatches will be a list of DataFrames with columns:
<code>seq</code>, <code>score</code>, <code>direction</code>, <code>start</code>, <code>end</code>, <code>from_centre</code>, <code>seq_width</code>,
<code>motif</code> and <code>match</code></p>
<p>The first three columns describe the sequence with matches, the score of
the match and whether the match was found using the forward or reverse PWM.
The columns <code>start</code>, <code>end</code> and <code>width</code> describe the where the match was found
in the sequence, whilst <code>from_centre</code> defines the distance between the centre
of the match and the centre of the sequence being queried.
The motif column denotes which individual motif was found to match in this
position, again noting that when matches overlap, only the one with the
highest relative score is returned.
The final column contains the matching fragment of the sequence as an
<code>XStringSet</code>.</p>
<p>Output from countClusterMatches will be a simple integer vector the same
length as the number of clusters</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function extends <a href="getPwmMatches.html">getPwmMatches</a> by returning a single set of
results for set of clustered motifs.
This can help remove some of the redundancy in results returned for highly
similar PWMs, such as those in the GATA3 family.</p>
<p>Taking a set of sequences as an XStringSet, find all matches above the
supplied score (i.e. threshold) for a list of Position Weight Matrices
(PWMs), which have been clustered together as highly-related motifs.
By default, matches are performed using the PWMs as provided and the reverse
complement, however this can easily be disabled by setting <code>rc = FALSE</code>.</p>
<p>The function relies heavily on <a href="https://rdrr.io/pkg/Biostrings/man/matchPWM.html" class="external-link">matchPWM</a> and
<a href="https://rdrr.io/pkg/IRanges/man/Views-class.html" class="external-link">Views</a> for speed.</p>
<p>Where overlapping matches are found for the PWMs within a cluster, only a
single match is returned.
The motif with the highest relative score (score / maxScore(PWM)) is selected.</p>
<p>When choosing to return the best match (<code>best_only = TRUE</code>), only the match
with the highest relative score is returned for each sequence.
Should there be tied scores, the best match can be chosen as either the first,
last, most central, all tied matches, or choosing one at random (the default).</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://github.com/smped" class="external-link">Stevie Pederson</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

