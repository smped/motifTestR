<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Assign each motif to a cluster — clusterMotifs • motifTestR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Assign each motif to a cluster — clusterMotifs"><meta name="description" content="Cluster related motifs for testing as a group"><meta property="og:description" content="Cluster related motifs for testing as a group"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="default" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">motifTestR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/motifAnalysis.html">Basic Motif Analysis</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/smped/motifTestR" aria-label="View on github"><span class="fa fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Assign each motif to a cluster</h1>
      <small class="dont-index">Source: <a href="https://github.com/smped/motifTestR/blob/gh-actions/R/clusterMotifs.R" class="external-link"><code>R/clusterMotifs.R</code></a></small>
      <div class="d-none name"><code>clusterMotifs.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Cluster related motifs for testing as a group</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">clusterMotifs</span><span class="op">(</span></span>
<span>  <span class="va">motifs</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PPM"</span>, <span class="st">"ICM"</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PCC"</span>, <span class="st">"EUCL"</span>, <span class="st">"SW"</span>, <span class="st">"KL"</span>, <span class="st">"ALLR"</span>, <span class="st">"BHAT"</span>, <span class="st">"HELL"</span>, <span class="st">"SEUCL"</span>, <span class="st">"MAN"</span>,</span>
<span>    <span class="st">"ALLR_LL"</span>, <span class="st">"WEUCL"</span>, <span class="st">"WPCC"</span><span class="op">)</span>,</span>
<span>  power <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  agglom <span class="op">=</span> <span class="st">"complete"</span>,</span>
<span>  thresh <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  labels <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cex <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  linecol <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-motifs">motifs<a class="anchor" aria-label="anchor" href="#arg-motifs"></a></dt>
<dd><p>A list of universalmotifs or a list of PWMs</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>Can be ICM or PPM</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>The moetho to be used for determining similarity/distances</p></dd>


<dt id="arg-power">power<a class="anchor" aria-label="anchor" href="#arg-power"></a></dt>
<dd><p>Raise correlation matrices to this power before converting to a
distance matrix. Only applied if method is either "PCC" or "WPCC"</p></dd>


<dt id="arg-agglom">agglom<a class="anchor" aria-label="anchor" href="#arg-agglom"></a></dt>
<dd><p>Method to be used for agglomeration by <a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></p></dd>


<dt id="arg-thresh">thresh<a class="anchor" aria-label="anchor" href="#arg-thresh"></a></dt>
<dd><p>Tree heights below which motifs are formed into a cluster</p></dd>


<dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p>Show tree produced by <a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a>. If requested the
value set by thresh will be shown as a horizontal line</p></dd>


<dt id="arg-labels-cex">labels, cex<a class="anchor" aria-label="anchor" href="#arg-labels-cex"></a></dt>
<dd><p>Passed to <a href="https://rdrr.io/r/stats/hclust.html" class="external-link">plot.hclust</a></p></dd>


<dt id="arg-linecol">linecol<a class="anchor" aria-label="anchor" href="#arg-linecol"></a></dt>
<dd><p>Passed to <a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a> as the argument <code>col</code></p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>passed to <a href="https://rdrr.io/pkg/universalmotif/man/compare_motifs.html" class="external-link">compare_motifs</a></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Named vector with numeric values representing which cluster each
motif has been assigned to.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This builds on <a href="https://rdrr.io/pkg/universalmotif/man/compare_motifs.html" class="external-link">compare_motifs</a>, enabling the
assignment of each PWM to a cluster, and subsequent testing of motifs as
a cluster, rather than returning individual results.</p>
<p>Internally all matrices are converted to distance matrices and
<a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a> is used to form clusters. By default, options such as
"EUCL", "MAN" produce distances, whilst similarity matrices are produced
when choosing "PCC" and other correlation based metrics. In these cases, the
distance matrix is obtained by taking 1 - similarity.</p>
<p>By default PWM labels are hidden (labels = FALSE), however these can be shown
using labels = NULL as explained in <a href="https://rdrr.io/r/stats/hclust.html" class="external-link">plot.hclust</a>.</p>
<p>Raising the threshold will lead to fewer, larger clusters whilst leaving
this value low will return a more conservative approach, with more smaller
clusters.
The final decision as the best clustering strategy is highly subjective and
left to the user.
Manual inspection of motifs within a cluster can be performed using
<a href="https://rdrr.io/pkg/universalmotif/man/view_motifs.html" class="external-link">view_motifs</a>, as shown in the vignette.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Load the example motifs</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ex_pfm"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Return a vector with each motif assigned a cluster</span></span></span>
<span class="r-in"><span><span class="co"># The default uses Pearson's Correlation Coefficient</span></span></span>
<span class="r-in"><span><span class="fu">clusterMotifs</span><span class="op">(</span><span class="va">ex_pfm</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ESR1  ANDR FOXA1 ZN143 ZN281 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1     2     2     3     4 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Preview the settings noting that showing labels can clutter the plot</span></span></span>
<span class="r-in"><span><span class="co"># with large numbers of motifs. The defaults for Euclidean distance</span></span></span>
<span class="r-in"><span><span class="co"># show the threshold may need raising</span></span></span>
<span class="r-in"><span><span class="fu">clusterMotifs</span><span class="op">(</span><span class="va">ex_pfm</span>, plot <span class="op">=</span> <span class="cn">TRUE</span>, labels <span class="op">=</span> <span class="cn">NULL</span>, method <span class="op">=</span> <span class="st">"EUCL"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="clusterMotifs-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ESR1  ANDR FOXA1 ZN143 ZN281 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1     2     3     4     5 </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/smped" class="external-link">Stevie Pederson</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer></div>





  </body></html>

